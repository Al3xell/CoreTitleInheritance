core_title_number_calc = {
    scope = character
    effect = {
        set_variable = {
            name = _num_core_titles
            value = num_core_titles
        }
    }
}

core_title_text_line = {
    scope = character

    is_shown = {
        has_core_titles = yes
    }
    
    is_valid = { # multiple core titles
        1 < num_core_titles
    }
    
    effect = {
        set_variable = {
            name = _core_limit
            value = val_core_limit
        }
        set_variable = {
            name = _core_count
            value = core_count
        }
    }
}

core_limit_display = {
    scope = character
    
   
    is_shown = {
        is_over_core_limit = yes
    }
    
    
    effect = {
        # Generate tooltip
        custom_tooltip = CORE_LIMIT_TOOLTIP_HEADER
        if = {
            limit = {is_over_core_limit = yes}
            custom_tooltip = CORE_LIMIT_EXCEEDED_TOOLTIP
            amount_over_core_limit = {save_temporary_scope_as = _amount_over_core_limit}
            if = {
                limit = {
                    amount_over_core_limit > 1
                }
                custom_tooltip = CORE_LIMIT_OVER_EFFECTS_HEADING_TOOLTIP
            }
            else = {
                custom_tooltip = CORE_LIMIT_OVER_EFFECTS_SINGULAR_HEADING_TOOLTIP
            }
            set_variable = {
                name = _val_over_core_limit_penalty
                value = -0.05
            }
            change_variable = {
                name = _val_over_core_limit_penalty
                multiply = root.amount_over_core_limit
            }
            custom_tooltip = CORE_LIMIT_OVERRUN_EFFECT
        }
    }
}

core_capital_chain_character_display = {
    scope = character
    
    is_valid = { # multiple capital chain cores
        1 < count_core_due_to_capital
    }
}

core_capital_chain_title_display = {
    scope = title
    
    is_shown = {
        is_title_core_due_to_capital = yes
    }
}

core_special_character_display = {
    scope = character
    
    is_shown = {
        trigger_if = {
            limit = {has_variable_list = core_title_list}
            any_held_title = {
                is_core_title = yes
                is_title_special_core = yes
            }# should check if the list is empty.
        }
        trigger_else = {
            always = no
        }
    }
    
    is_valid = { # multiple special cores
        1 < root.count_core_due_to_special
    }
}

core_special_title_display = {
    scope = title
    
    
    is_shown = {
        is_title_special_core = yes
    }
}

core_mod_character_display = {
    scope = character
    
    is_shown = {
        trigger_if = {
            limit = {has_variable_list = core_title_list}
            any_held_title = {
                is_title_core = yes
                is_title_core_due_to_cti = yes
            }# should check if the list is empty.
        }
        trigger_else = {
            always = no
        }
    }
    
    is_valid = { # multiple special cores
        1 < count_core_due_to_mod
    }
}

core_mod_title_display = {
    scope = title
    
    
    is_shown = {
        is_title_core = yes
        is_title_core_due_to_cti = yes
    }
}